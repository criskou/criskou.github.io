<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>自动化测试 | Cris Kou的成长日记</title><meta name="keywords" content="自动化测试"><meta name="author" content="Cris Kou"><meta name="copyright" content="Cris Kou"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="自动化测试"><meta name="application-name" content="自动化测试"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="自动化测试"><meta property="og:url" content="http://example.com/2025/02/16/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/index.html"><meta property="og:site_name" content="Cris Kou的成长日记"><meta property="og:description" content="自动化测试这里简单滴记录一哈自动化入门学习笔记，后续陆续补充。 WEB UI自动化Selenium工作原理 自动化程序调用Selenium客户端库， 客户端库发送请求给浏览器驱动， 浏览器驱动再转发这个请求给浏览器， 浏览器将结果返回给浏览器驱动， 浏览器驱动再通过HTTP响应消息返回给Seleni"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta property="article:author" content="Cris Kou"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta name="description" content="自动化测试这里简单滴记录一哈自动化入门学习笔记，后续陆续补充。 WEB UI自动化Selenium工作原理 自动化程序调用Selenium客户端库， 客户端库发送请求给浏览器驱动， 浏览器驱动再转发这个请求给浏览器， 浏览器将结果返回给浏览器驱动， 浏览器驱动再通过HTTP响应消息返回给Seleni"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2025/02/16/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"不点回来，我！就！要！闹！","backTitle":"列队欢迎大佬！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手"]},
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Cris Kou","link":"链接: ","source":"来源: Cris Kou的成长日记","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Cris Kou的成长日记',
  title: '自动化测试',
  postAI: '',
  pageFillDescription: '自动化测试, WEB UI自动化, Selenium, 工作原理, 安装, 示例, 常见问题, 选择元素, 根据id属性定位元素, 根据class属性选择元素, 根据tag名定位元素, 通过WebElement对象定位元素, 操控元素, CSS表达式, 根据 tag名、id、class 选择元素, 选择子元素和后代元素, 根据属性选择, 联合使用, 组选择, 按次序选择子节点, 兄弟节点选择, XPath选择器, 绝对路径选择, 相对路径选择, 通配符, 根据属性选择, 按次序选择, 范围选择, 组选择、父节点、兄弟节点, API接口自动化, HTTP协议, HTTP请求消息, 请求行 request line, 请求头 request headers, 消息体 message body, HTTP响应消息, 状态行 status line, 响应头 response headers, 消息体 message body, 接口测试概述, Requests库, 实例, requests程序抓包设置代理为Fiddler, 构建请求参数 params, 构建请求消息头 headers, 构建请求消息体 data, XML格式, urlencoded 格式消息体, JSON 格式消息体, 检查响应状态码, 检查响应消息头, 检查响应消息体, Session, requests处理session-Cookie, Session对象使用代理, 接口测试数据准备, 封装API测试类, 配置文件, 自动化测试框架Pytetst, 概述, 安装, 快速上手, 初始化清除, 模块级别, 类级别, 方法级别, 目录级别, 挑选用例执行, 指定一个模块, 指定一个或多个目录, 指定模块里面的函数或者类, 根据名字, 根据标签, 数据驱动, 使用 fixture, 例子, fixture本身需要参数, fixture范围自动化测试这里简单滴记录一哈自动化入门学习笔记后续陆续补充自动化工作原理自动化程序调用客户端库客户端库发送请求给浏览器驱动浏览器驱动再转发这个请求给浏览器浏览器将结果返回给浏览器驱动浏览器驱动再通过响应消息返回给客户端客户端将相应数据转化为数据对象返回给自动化代码安装即可安装库还需要安装对应版本的浏览器驱动官方下载地址或者淘宝镜像源下载地址其他浏览器安装相应的驱动示例自动化打开浏览器创建对象指明使用的浏览器驱动如果设置了环境变量括号里可以不写驱动路径调用对象的方法打开指定网址程序运行结束会自动退出浏览器这里加入等待用户输入回车结束防止闪退等待回车键结束程序执行完自动化代码如果想关闭浏览器窗口可以调用对象的方法像这样常见问题关闭日志缺省情况下启动后会在屏幕上输出不少日志信息可以这样关闭浏览器首页显示防病毒重置设置有时打开浏览器会弹出防病毒重置您的设置页面可以这样操作命令行输入运行注册表编辑器在左边的目录树找到删除其下的子项选择元素可以使用浏览器开发者调试工具点击标签在点击左上角图标然后在网页上选择元素就会自动高亮该元素的代码可以看到有等属性他们都可以用来定位元素根据属性定位元素是当前页面唯一的但是有时候元素可能会没有先看怎么根据定位元素返回值是该元素对应的对象名称可以通过该对象对元素进行操作比如输入字符串到元素输入框中点击该元素布拉布拉根据属性选择元素注意是多了个打印每一个元素的文本比如猴子就会打印猴子找到的是所有符合条件的元素放在一个列表中返回如果使用少了一个就只会返回第一个元素如果元素有多个属性值比如燕子可以指定任意一个属性值都可以定位到该元素根据名定位元素就是元素通过对象定位元素对象选择的是整个页面的元素这样选择的是该元素内部的子元素限制选择元素的范围是为元素的内部操控元素点击元素输入框清除已有提示字符串输入新字符串布拉布拉获取元素文本内容这样可以获取展示在界面上的文本内容但是有时候元素的文本内容没有展示在界面上或者没有完全完全展示在界面上这时可以用应对显示不全的情况能够显示属性为的部分获取元素属性获取整个元素对应的获取整个获取该元素内部的获取输入框里的文字表达式当要选择的元素没有属性或者有些我们不想选择的元素也有相同的属性值可以通过定位元素可以参考选择器参考手册根据名选择元素根据属性选择元素的语法是在号前面加上一个井号值根据属性选择元素的语法是在值前面加上一个点值选择子元素和后代元素如果元素是元素的直接子元素选择子元素的语法是这样的元素元素如果元素是元素的后代元素中间是一个或者多个空格隔开元素元素根据属性选择支持通过任何属性来选择元素语法是用一个方括号苏备号前面还可以加上标签名的限制比如表示选择所有标签名为且属性值为的元素还可以不指定属性值比如表示选择所有具有属性名为的元素不管它们的值是什么还可以选择属性值包含某个字符串的元素比如要选择节点里面的属性包含了字符串就可以这样写还可以选择属性值以某个字符串开头的元素比如要选择节点里面的属性以开头就可以这样写同样结尾多个属性的限制沙漠之鹰点击标签就会出现搜索框可以用来验证表达式联合使用的另一个强大之处在选择语法可以联合使用版权选择一个属性值为的节点并且要求其必须是属性值为的节点的子节点不限制类型的简单写法组选择同时选择所有为和为的元素选择所有为里面的和元素不能写成因为逗号是组选择器的分隔符注意组选择结果列表中选中元素排序不是组表达式的次序而是符合这些表达式的元素在文档中的出现的次序按次序选择子节点唐诗李白静夜思杜甫春夜喜雨宋词苏轼赤壁怀古明月几时有江城子乙卯正月二十日夜记梦蝶恋花春景辛弃疾京口北固亭怀古青玉案元夕西江月夜行黄沙道中需求选择唐诗和宋词的第一个作者父元素的第个子节点注意理解这里表示的是该元素是父元素的第二个子元素而不是元素的第二个子元素父元素的倒数第个子节点父元素的第几个某类型的子节点上述需求还可以这样思考选择的是第个类型的子元素选择的是第个类型的子元素父元素的倒数第几个某类型的子节点偶数节点和奇数节点兄弟节点选择上述需求还有一种思考方法就是选择后面紧跟着的兄弟节点相邻兄弟节点选择加号后续所有兄弟节点选择选择器是由国际标准化组织指定的用来在和文档中选择节点的语言选择器参考选择器参考手册有些场景用选择元素很麻烦而却比较方便另外还有其他领域会使用到比如爬虫框架手机框架语法中整个文档根节点用表示如果我们想选择的是根节点下面的节点则可以在搜索框输入绝对路径选择从根节点开始到某个节点每层都依次写下来每层之间用分隔的表达式就是某元素的绝对路径等价于表达式相对路径选择选择网页中某个元素不管它在什么位置如果使用表达式直接写一个就行了表达式应该这样写通配符如果要选择所有节点的所有直接子节点可以使用表达式根据属性选择根据属性来选择元素的语法是属性名属性值根据属性选择选择为的元素可以这样根据属性选择选择所有元素中为的元素可以这样如果一个元素有多个比如北京就应该是不能只写一个属性根据其他属性例如选择具有属性的所有页面元素可以这样属性值包含字符串选择属性值包含字符串的页面元素选择属性值以字符串开头的页面元素如果是结尾呢很遗憾是的语法目前浏览器都不支持按次序选择也可以根据次序选择元素语法比更简洁直接在方括号中使用数字表示次序选择类型第个的子元素第几个子元素选择父元素为的第个子元素不管是什么类型某类型倒数第几个子元素选取类型倒数第个子元素选取类型倒数第个子元素数字是写在括号外面的范围选择选取类型第到个子元素选择属性为的前个子元素选择属性为的后个子元素组选择父节点兄弟节点组选择用竖线隔开多个表达式选所有的元素和所有的元素选择父节点可以选择父节点这是做不到的某个元素的父节点用表示当某个元素没有特征可以直接选择但是它有子节点有特征就可以采用这种方法先选择子节点再指定父节点选择为的节点的父节点兄弟节点选择语法选择为的元素的所有后续兄弟节点等同于选择器选择为的元素的前面第最靠近的兄弟节点目前还做不到注意要在某个元素内部使用选择元素需要在表达式最前面加个点定位元素内部的所有元素接口自动化协议协议全称是超文本传输协议英文是最初是用来在浏览器和网站服务器服务之间传输超文本网页视频图片等信息的由于简洁易用后来不仅仅是浏览器和服务器之间使用它服务器和服务器之间手机和服务器之间都广泛的采用成了软件系统间通信的首选协议之一有好几个版本包括当前最广泛使用的是版本以前版本除了基于准确来说是基于协议是基于的都是基于协议的所以要进行通讯客户端必须先和服务端创建连接而且双方的信息交互必须是这样一种方式客户端先发送请求给服务端然后服务端发送响应给客户端特别注意协议中服务端不能主动先发送信息给客户端而且在以前的版本服务端返回响应给客户端后连接就会断开下一次双方要进行信息交流必须重复上面的过程重新建立连接客户端发送请求服务返回响应到了版本建立连接后这个连接可以保持一段时间这段时间双方可以多次进行请求和响应无需重新建立连接请求消息请求行以下为请求头请求行以下为请求头消息体请求行包含请求方式协议版本请求方式等请求头关于请求头标准的描述单个请求头的格式是名字值一个请求头占据一行开发者也可以在消息中添加自己定义的请求头消息体等请求添加修改的数据信息通常都是存放在请求消息体中的消息头和消息体之间需要插入一个空行隔开请求消息体通常是某种格式的文本常见的有表单数据响应消息状态行状态行状态码通常表示请求消息没有问题而且服务器也正确处理了重定向响应常见的值是表示客户端的这个请求的地址已经改变了需要客户端重新发起一个请求到另外的一个表示客户端请求有错误常见的值有表示客户端请求不符合接口要求比如格式完全错误表示客户端需要先认证才能发送次请求表示客户端没有权限要求服务器处理这样的请求比如普通用户请求删除别人账号等表示客户端请求的不存在表示服务端在处理请求中发生了未知的错误通常是服务端的代码设计问题或者是服务端子系统出了故障比如数据库服务宕机了响应头作用与请求头类似消息体接口测试概述接口传递数据信息是通过协议进行收发的网站获取网页图片等资源也是通过协议进行收发的两者的不同点在于网页图片这些资源都是静态资源服务端直接读取文件返回给客户端即可无需特别的数据处理而接口请求消息通常都需要服务端程序进行一番处理比如对请求的权限检查从数据库中读出数据进行信息过滤和格式转换最后在响应中返回给客户端内部接口通常是由开发来做测试来做内部的接口测试时重点是做漏洞测试和破坏性测试就好了而外部接口也就是第三方接口测试工程师一定要进行全面测试库官网实例返回对象程序抓包设置代理为还需要安装证书然后执行命令安装一个第三方库这样会让使用本地系统安装的证书构建请求参数构建请求消息头构建请求消息体消息体可能很短只有一个字节比如字符也可能很长有几百兆个字节比如一个视频文件最常见的消息体格式当然是表示网页内容的消息体就是存放信息的地方信息的格式完全取决设计者的需要而接口中消息体基本都是文本文本的格式主要是这种格式良好暂无缺省会使用编码格式消息体这种格式的消息体就是一种键值对的格式存放数据可以放到字典里传递格式消息体良好问题问题使用库的方法构建对象也可以将数据对象直接传递给方法的参数如下检查响应状态码检查响应消息头可以更美观的打印数据直观的展示数据结构检查响应消息体会根据响应消息头比如对编码格式做推测从而包响应消息体中的字节串解码为字符串但是有时没有指定编码格式就需要手动指定要直接获取消息体中的字节串内容可以使用有需要时指定解码方式对于格式的消息体可以通过库的函数把它转化为对象库为我们提供了更方便的方法可以使用对象的方法前面学习过客户端访问服务器时服务器会生成唯一并通过响应头的字段响应给客户端这个唯一就是在生成的同时服务器还生成了这样一个数据结构保存该客户这次登录操作相关信息通常保存在数据库中处理库给我们提供一个类通过这个类无需我们操心库自动帮我们保存服务端返回的数据请求自动在消息头中放入数据创建对象通过对象发送请求还可以这样写没有上面简洁如果这样写后续发送会请求消息头中会丢掉中的数据必须像下面这样写才能让请求包含数据对象使用代理接口测试数据准备如果测试的时候系统前端已经开发完毕在前端删除否则可以通过删除接口删除尽量不要在数据库中直接删除数据封装测试类可以把发送接收消息封装到库中这样可以使我们的测试代码更加简洁比如我们可以创建一个的库调用配置文件我们注意到库文件里面发送请求都是写死了请求的这样做的问题是如果我们测试系统安装在另外的机器上这些代码都得更改地址所以我们应该把被测系统的主机地址写在配置文件中如下所示然后其他代码使用配置文件里面的主机地址像这样登录自动化测试框架概述基于语言的自动化测试框架最知名的有如下款前两款框架主要或者说很大程度上是聚焦在白盒单元测试而主要聚焦在系统测试可以用来做系统测试的自动化它的特点有用编写测试用例简便易用可以用文件系统目录层次对应手工测试用例层次结构灵活的初始化清除机制可以灵活挑选测试用例执行利用第三方插件可以生成不错的报表安装安装即可快速上手编写的测试用例代码文件必须以开头或者以结尾如果把测试用例存放在类中类名必须以为前缀的类用例对应的方法必须以为前缀的方法中用例的检查点直接用的断言进入项目根录执行即可注意直接执行命令不会将当前目录设置为模块搜索路径所以更推荐执行命令打印测试代码中的内容打印详细的执行信息如测试类测试函数的名字目标扫描目录路径产生测试报告初始化清除对自动化测试框架来说初始化清除功能至关重要模块级别模块级别的初始化清除分别在整个模块的测试用例执行前后执行并且只会执行次初始化模块清除模块类级别错误密码类方法装饰器第一个参数固定为而不是初始化类清除类用例类方法装饰器可以通过类名方法名调用该方法第一个参数固定为而不是统计类创建了多少个实例从字符串构造对象类方法可以替代构造方法根据不同的类型参数返回不同的子类对象方法级别类中没有类方法装饰器初始化方法清除方法用例目录级别在需要初始化的目录下面创建一个名为的文件里面内容如下所示这是一个生成器初始化目录甲在这里写清除环境的代码清除目录甲挑选用例执行指定一个模块登录错误登录指定一个或多个目录登录指定模块里面的函数或者类指定一个类登录错误登录错误密码指定类中的方法登录错误登录错误密码根据名字可以是要测试函数名字的一部分并且可以用和来进行筛选错密码错密码根据标签错误密码用例执行命令也可以给整个类加上标签并且可以是中文可以添加多个标签登录测试错误密码用例可以这样定义一个全局变量为整个模块文件设定标签网页测试如果需要定义多个标签可以定义一个列表网页测试登录测试自定义的标签运行时会有告警可以在项目根目录下创建配置文件并且在里面设置标签配置项如下网页测试标记为网页测试数据驱动如果有一批测试用例具有相同的测试步骤只是测试参数数据不同自动化测试时把测试数据从用例代码中分离开来以后增加新的测试用例只需要修改数据这就是数据驱动错误登录请输入用户名请输入密码登录失败用户名或者密码错误登录失败用户名或者密码错误登录失败用户名或者密码错误参考官网数据驱动使用前面讲初始化清除时主要用的是风格的初始化清除方法里面有更灵活方便的初始化清除方法就是使用跟的依赖注入类似例子定义一个函数执行创建张三账号的代码这是系统创建用户产生的其它信息用代替这里写清除部分的代码执行清除张三账号的代码参数为函数名用例本身需要参数就需要使用装饰器并指定参数定义一个函数这里代码实现了使用创建用户账号功能这是系统创建用户产生的其它信息用例测试行为用例测试行为这里参数是特殊的名字是内置的对象这个对象的属性是一个里面保存了传入的一个个参数范围由小到大有下面这几种级别范围函数级别缺省值会在测试函数结束时执行对应的清除类级别会在类里面的最后一个测试方法结束时执行对应的清除模块文件级别会在模块文件里面的最后一个测试方法结束时执行对应的清除目录级别会在目录里面的最后一个测试方法结束时执行对应的清除整个测试级别会在整个测试的最后一个测试方法结束时执行对应的清除缺省为函数级别参数的作用为是否设置默认使用设置为后就不用在用例方法的参数中写上函数名了会自动调用参考链接',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-02-16 21:25:21',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">Cris Kou的成长日记</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>1</sup></a><a href="/tags/Python%E5%9F%BA%E7%A1%80/" style="font-size: 1.05rem;">Python基础<sup>1</sup></a><a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 1.05rem;">学习笔记<sup>1</sup></a><a href="/tags/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/" style="font-size: 1.05rem;">测试工具<sup>3</sup></a><a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" style="font-size: 1.05rem;">自动化测试<sup>1</sup></a><a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" style="font-size: 1.05rem;">读书笔记<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/02/"><span class="card-archive-list-date">二月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">8</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>自动化测试</span></a></span></div></div><h1 class="post-title" itemprop="name headline">自动化测试</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-02-16T01:42:27.000Z" title="发表于 2025-02-16 09:42:27">2025-02-16</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-02-16T13:25:21.239Z" title="更新于 2025-02-16 21:25:21">2025-02-16</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为成都"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>成都</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2025/02/16/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"><header><a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" tabindex="-1" itemprop="url">自动化测试</a><h1 id="CrawlerTitle" itemprop="name headline">自动化测试</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Cris Kou</span><time itemprop="dateCreated datePublished" datetime="2025-02-16T01:42:27.000Z" title="发表于 2025-02-16 09:42:27">2025-02-16</time><time itemprop="dateCreated datePublished" datetime="2025-02-16T13:25:21.239Z" title="更新于 2025-02-16 21:25:21">2025-02-16</time></header><h1 id="自动化测试"><a href="#自动化测试" class="headerlink" title="自动化测试"></a>自动化测试</h1><p>这里简单滴记录一哈自动化入门学习笔记，后续陆续补充。</p>
<h2 id="WEB-UI自动化"><a href="#WEB-UI自动化" class="headerlink" title="WEB UI自动化"></a>WEB UI自动化</h2><h3 id="Selenium"><a href="#Selenium" class="headerlink" title="Selenium"></a>Selenium</h3><h4 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h4><ul>
<li>自动化程序调用Selenium客户端库，</li>
<li>客户端库发送请求给<strong>浏览器驱动</strong>，</li>
<li>浏览器驱动再转发这个请求给浏览器，</li>
<li>浏览器将结果返回给浏览器驱动，</li>
<li>浏览器驱动再通过HTTP响应消息返回给Selenium客户端，</li>
<li>Selenium客户端将相应数据转化为数据对象返回给自动化代码。</li>
</ul>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p><code>pip install selenium</code>即可安装Selenium库。还需要安装对应版本的浏览器驱动。</p>
<p> <a target="_blank" rel="noopener" href="https://googlechromelabs.github.io/chrome-for-testing/">Chrome driver 官方下载地址</a>或者<a target="_blank" rel="noopener" href="https://registry.npmmirror.com/binary.html?path=chrome-for-testing/">Chrome driver 淘宝镜像源下载地址</a>，其他浏览器安装相应的驱动。</p>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><p>自动化打开chrome浏览器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建WebDriver对象，指明使用的浏览器驱动</span></span><br><span class="line"><span class="comment"># 如果设置了环境变量，括号里可以不写</span></span><br><span class="line">WebDriver = webdriver.Chrome(service = Service(<span class="string">&quot;驱动路径&quot;</span>)) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用WebDriver对象的get方法，打开指定网址</span></span><br><span class="line">WebDriver.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 程序运行结束会自动退出浏览器，这里加入等待用户输入回车结束，防止“闪退”</span></span><br><span class="line"><span class="built_in">input</span>(<span class="string">&#x27;等待回车键结束程序&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>执行完自动化代码，如果想关闭浏览器窗口可以调用WebDriver对象的 quit 方法，像这样 wd.quit()</p>
</blockquote>
<h4 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h4><ul>
<li>关闭chromedriver日志</li>
</ul>
<p>缺省情况下启动chromedriver后，会在屏幕上输出不少日志信息，可以这样关闭：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">options = webdriver.ChromeOptions()</span><br><span class="line">options.add_experimental_option(</span><br><span class="line">	<span class="string">&#x27;excludeSwitches&#x27;</span>, [<span class="string">&#x27;enable-logging&#x27;</span>]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">wd = webdriver.Chrome(options = options)</span><br></pre></td></tr></table></figure>

<ul>
<li>浏览器首页显示防病毒重置设置</li>
</ul>
<p>有时打开浏览器会弹出Windows Defender防病毒重置您的设置页面，可以这样操作：</p>
<blockquote>
<p>命令行输入 <code>regedit</code> ，运行注册表编辑器</p>
<p>在左边的目录树找到 <code>HKEY_CURRENT_USER\Software\Google\Chrome</code></p>
<p>删除其下的 <code>TriggeredReset</code> 子项</p>
</blockquote>
<h4 id="选择元素"><a href="#选择元素" class="headerlink" title="选择元素"></a>选择元素</h4><p>可以使用浏览器开发者调试工具F12，点击Elements标签，在点击左上角图标，然后在网页上选择元素，就会自动高亮该元素的代码。可以看到有<code>id</code>、<code>class</code>等属性，他们都可以用来定位元素。</p>
<h5 id="根据id属性定位元素"><a href="#根据id属性定位元素" class="headerlink" title="根据id属性定位元素"></a>根据id属性定位元素</h5><p>id是当前html页面唯一的，但是有时候元素可能会没有id，先看怎么根据id定位元素：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line"><span class="meta">... </span>...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回值是该元素对应的WebElement对象</span></span><br><span class="line">element = wd.find_element(By.ID, <span class="string">&#x27;id名称&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以通过该对象对元素进行操作，比如输入字符串到元素输入框中</span></span><br><span class="line">element.click() <span class="comment"># 点击该元素</span></span><br><span class="line">element.send_keys(<span class="string">&#x27;布拉布拉\n&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="根据class属性选择元素"><a href="#根据class属性选择元素" class="headerlink" title="根据class属性选择元素"></a>根据class属性选择元素</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意是elements，多了个s</span></span><br><span class="line">elements = wd.find_elements(By.CLASS_NAME, <span class="string">&#x27;animal&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印每一个元素的文本，比如&lt;div class=animal&gt;猴子&lt;/div&gt;就会打印猴子</span></span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> elements:</span><br><span class="line">    <span class="built_in">print</span>(element.text)</span><br></pre></td></tr></table></figure>

<p>找到的是所有符合条件的元素，放在一个列表中返回，如果使用find_element（少了一个s），就只会返回第一个元素。</p>
<p>如果元素有多个class属性值，比如<code>&lt;div class=&#39;animal bird&#39;&gt;燕子&lt;/div&gt;</code>，可以指定任意一个class属性值，都可以定位到该元素。</p>
<h5 id="根据tag名定位元素"><a href="#根据tag名定位元素" class="headerlink" title="根据tag名定位元素"></a>根据tag名定位元素</h5><p>tag就是html元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = wd.find_elements(By.TAG_NAME, <span class="string">&#x27;div&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="通过WebElement对象定位元素"><a href="#通过WebElement对象定位元素" class="headerlink" title="通过WebElement对象定位元素"></a>通过WebElement对象定位元素</h5><p>webdriver对象选择的是整个web页面的元素，这样选择的是该元素内部的子元素。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">element = wd.find_element(By.ID,<span class="string">&#x27;container&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 限制 选择元素的范围是 id 为 container 元素的内部。</span></span><br><span class="line">spans = element.find_elements(By.TAG_NAME, <span class="string">&#x27;span&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="操控元素"><a href="#操控元素" class="headerlink" title="操控元素"></a>操控元素</h5><ul>
<li><p>点击元素</p>
</li>
<li><p>输入框</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 清除已有提示字符串</span></span><br><span class="line">element.clear()</span><br><span class="line"><span class="comment"># 输入新字符串</span></span><br><span class="line">element.send_keys(<span class="string">&#x27;布拉布拉&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取元素文本内容</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(element.text)</span><br></pre></td></tr></table></figure>

<p>这样可以获取<strong>展示在界面上</strong>的文本内容，但是有时候，元素的文本内容没有展示在界面上，或者没有完全完全展示在界面上。这时可以用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">element.get_attribute(<span class="string">&#x27;innerText&#x27;</span>) <span class="comment"># 应对显示不全的情况</span></span><br><span class="line">element.get_attribute(<span class="string">&#x27;textContent&#x27;</span>) <span class="comment"># 能够显示display属性为none的部分</span></span><br></pre></td></tr></table></figure>


</li>
<li><p>获取元素属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element.get_attribute(<span class="string">&#x27;class&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取整个元素对应的html</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">element.get_attribute(<span class="string">&#x27;outerHTML&#x27;</span>) <span class="comment"># 获取整个html</span></span><br><span class="line">element.get_attribute(<span class="string">&#x27;innerHTML&#x27;</span>) <span class="comment"># 获取该元素内部的html</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>获取输入框里的文字</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element.get_attribute(<span class="string">&#x27;value&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="CSS表达式"><a href="#CSS表达式" class="headerlink" title="CSS表达式"></a>CSS表达式</h5><p>当要选择的 元素 没有id、class 属性，或者有些我们不想选择的元素也有相同的 id、class属性值，可以通过CSS Selector定位元素。CSS Selector可以参考：<a target="_blank" rel="noopener" href="https://www.w3school.com.cn/cssref/css_selectors.asp">CSS选择器参考手册</a></p>
<h6 id="根据-tag名、id、class-选择元素"><a href="#根据-tag名、id、class-选择元素" class="headerlink" title="根据 tag名、id、class 选择元素"></a>根据 tag名、id、class 选择元素</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = wd.find_elements(By.CSS_SELECTOR, <span class="string">&#x27;div&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>根据id属性 选择元素的语法是在id号前面加上一个井号： <code>#id值</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#searchtext&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>根据class属性 选择元素的语法是在 class 值 前面加上一个点： <code>.class值</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = wd.find_elements(By.CSS_SELECTOR, <span class="string">&#x27;.animal&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h6 id="选择子元素和后代元素"><a href="#选择子元素和后代元素" class="headerlink" title="选择子元素和后代元素"></a>选择子元素和后代元素</h6><p>如果 <code>元素2</code> 是 <code>元素1</code> 的 直接子元素， CSS Selector 选择子元素的语法是这样的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">元素1 &gt; 元素2</span><br></pre></td></tr></table></figure>

<p>如果 <code>元素2</code> 是 <code>元素1</code> 的 后代元素，中间是一个或者多个空格隔开</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">元素1   元素2</span><br></pre></td></tr></table></figure>

<h6 id="根据属性选择"><a href="#根据属性选择" class="headerlink" title="根据属性选择"></a>根据属性选择</h6><p>支持通过任何属性来选择元素，语法是用一个方括号 <code>[]</code> 。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &lt;a href=&quot;http://www.miitbeian.gov.cn&quot;&gt;苏ICP备88885574号&lt;/a&gt;</span></span><br><span class="line">element = wd.find_element(By.CSS_SELECTOR, <span class="string">&#x27;[href=&quot;http://www.miitbeian.gov.cn&quot;]&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>前面还可以加上标签名的限制，比如 <code>div[class=&#39;SKnet&#39;]</code> 表示 选择所有 标签名为div，且class属性值为SKnet的元素。</p>
<p>还可以不指定属性值，比如 <code>[href]</code> ， 表示选择 所有 具有 属性名 为href 的元素，不管它们的值是什么。</p>
<p>还可以选择 属性值 <code>包含</code> 某个字符串的元素，比如， 要选择a节点，里面的href属性包含了miitbeian字符串，就可以这样写：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[href*=&quot;miitbeian&quot;]</span><br></pre></td></tr></table></figure>

<p>还可以选择属性值以某个字符串开头的元素，比如， 要选择a节点，里面的href属性以abc开头 ，就可以这样写：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[href^=&quot;abc&quot;]</span><br></pre></td></tr></table></figure>

<p>同样，结尾：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[href$=&quot;abc&quot;]</span><br></pre></td></tr></table></figure>

<p>多个属性的限制：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &lt;div class=&quot;misc&quot; ctype=&quot;gun&quot;&gt;沙漠之鹰&lt;/div&gt;</span></span><br><span class="line">div[<span class="keyword">class</span>=misc][ctype=gun]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>F12点击 Elements 标签， Ctrl+F， 就会出现搜索框，可以用来验证CSS Selector表达式</p>
</blockquote>
<h6 id="联合使用"><a href="#联合使用" class="headerlink" title="联合使用"></a>联合使用</h6><p>CSS selector的另一个强大之处在， 选择语法可以联合使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&lt;div class=&#x27;footer1&#x27;&gt;</span></span><br><span class="line"><span class="comment">#        &lt;span class=&#x27;copyright&#x27;&gt;版权&lt;/span&gt;</span></span><br><span class="line"></span><br><span class="line">div.footer1 &gt; span.copyright <span class="comment"># 选择 一个class属性值为copyright 的span节点， 并且要求其必须是class属性值为footer1的div节点的子节点</span></span><br><span class="line">.footer1 &gt; .copyright <span class="comment"># 不限制类型的简单写法</span></span><br></pre></td></tr></table></figure>

<h6 id="组选择"><a href="#组选择" class="headerlink" title="组选择"></a>组选择</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.plant , .animal <span class="comment"># 同时选择所有class 为 plant 和 class 为 animal 的元素</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 选择所有 id 为 t1 里面的 span 和 p 元素</span></span><br><span class="line">elements = wd.find_elements(By.CSS_SELECTOR, <span class="string">&#x27;#t1 &gt; span , #t1 &gt; p&#x27;</span>)</span><br><span class="line"><span class="comment"># 不能写成#t1 &gt; span,p因为逗号是组选择器的分隔符</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：组选择结果列表中，选中元素排序， 不是组表达式的次序， 而是符合这些表达式的元素，在HTML文档中的出现的次序。</p>
</blockquote>
<h6 id="按次序选择子节点"><a href="#按次序选择子节点" class="headerlink" title="按次序选择子节点"></a>按次序选择子节点</h6><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>  </span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;t1&#x27;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h3</span>&gt;</span> 唐诗 <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">span</span>&gt;</span>李白<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>静夜思<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">span</span>&gt;</span>杜甫<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>春夜喜雨<span class="tag">&lt;/<span class="name">p</span>&gt;</span>              </span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span>      </span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;t2&#x27;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">h3</span>&gt;</span> 宋词 <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">span</span>&gt;</span>苏轼<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>赤壁怀古<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>明月几时有<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>江城子·乙卯正月二十日夜记梦<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>蝶恋花·春景<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">span</span>&gt;</span>辛弃疾<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>京口北固亭怀古<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>青玉案·元夕<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">p</span>&gt;</span>西江月·夜行黄沙道中<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span>             </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>需求：选择唐诗和宋词的第一个作者：</p>
<ul>
<li>父元素的第n个子节点<code>nth-child</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = wd.find_elements(By.CSS_SELECTOR, <span class="string">&#x27;span:nth-child(2)&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意理解，这里nth-child表示的是：该元素是父元素的第二个子元素，而不是span元素的第二个子元素。</p>
</blockquote>
<ul>
<li><p>父元素的倒数第n个子节点<code>nth-last-child</code></p>
</li>
<li><p>父元素的第几个某类型的子节点<code>nth-of-type</code></p>
</li>
</ul>
<p>上述需求还可以这样思考，选择的是 <code>第1个span类型</code> 的子元素</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">span:nth-of-type(1) # 选择的是第1个span类型的子元素 </span><br></pre></td></tr></table></figure>

<ul>
<li>父元素的倒数第几个某类型的子节点<code>nth-last-of-type</code></li>
<li>偶数节点和奇数节点<code>nth-child(even)</code>、<code>p:nth-child(odd)</code></li>
</ul>
<h6 id="兄弟节点选择"><a href="#兄弟节点选择" class="headerlink" title="兄弟节点选择"></a>兄弟节点选择</h6><p>上述需求还有一种思考方法，就是选择 h3 <code>后面紧跟着的兄弟节点</code> span。</p>
<ul>
<li>相邻兄弟节点选择 加号<code>+</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">h3 + span</span><br></pre></td></tr></table></figure>

<ul>
<li>后续所有兄弟节点选择</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">h3 ~ span</span><br></pre></td></tr></table></figure>

<h5 id="XPath选择器"><a href="#XPath选择器" class="headerlink" title="XPath选择器"></a>XPath选择器</h5><p>XPath (XML Path Language) 是由国际标准化组织W3C指定的，用来在 XML 和 HTML 文档中选择节点的语言。XPath选择器参考：<a target="_blank" rel="noopener" href="https://www.w3school.com.cn/xpath/index.asp">XPath选择器参考手册</a>。</p>
<ul>
<li>有些场景 用 CSS 选择web 元素 很麻烦，而XPath 却比较方便。</li>
<li>另外 XPath 还有其他领域会使用到，比如 爬虫框架 Scrapy，手机App框架 Appium。</li>
</ul>
<p>XPath 语法中，整个HTML文档根节点用’&#x2F;‘表示，如果我们想选择的是根节点下面的html节点，则可以在F12搜索框输入<code>/html</code>。</p>
<h6 id="绝对路径选择"><a href="#绝对路径选择" class="headerlink" title="绝对路径选择"></a>绝对路径选择</h6><p>从根节点开始到某个节点，每层都依次写下来，每层之间用 <code>/</code> 分隔的表达式，就是某元素的绝对路径：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">elements = driver.find_elements(By.XPATH, <span class="string">&quot;/html/body/div&quot;</span>)  <span class="comment"># 等价于 css表达式 html&gt;body&gt;div</span></span><br></pre></td></tr></table></figure>

<h6 id="相对路径选择"><a href="#相对路径选择" class="headerlink" title="相对路径选择"></a>相对路径选择</h6><p>选择网页中某个元素，不管它在什么位置，如果使用CSS表达式，直接写一个 <code>div</code> 就行了，XPath表达式应该这样写： <code>//div</code></p>
<h6 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h6><p>如果要选择所有div节点的所有直接子节点，可以使用表达式 <code>//div/*</code></p>
<h6 id="根据属性选择-1"><a href="#根据属性选择-1" class="headerlink" title="根据属性选择"></a>根据属性选择</h6><p>根据属性来选择元素的语法是 <code>[@属性名=&#39;属性值&#39;]</code></p>
<ul>
<li>根据id属性选择</li>
</ul>
<p>选择 id 为 west 的元素，可以这样 <code>//*[@id=&#39;west&#39;]</code></p>
<ul>
<li>根据class属性选择</li>
</ul>
<p>选择所有 select 元素中 class 为 single_choice 的元素，可以这样 <code>//select[@class=&#39;single_choice&#39;]</code></p>
<p>如果一个元素class 有多个，比如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;beijing&quot;</span> <span class="attr">class</span>=<span class="string">&#x27;capital huge-city&#x27;</span>&gt;</span></span><br><span class="line">    北京    </span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>就应该是 <code>//p[@class=&quot;capital huge-city&quot;]</code>，不能只写一个属性。</p>
<ul>
<li>根据其他属性</li>
</ul>
<p>例如：选择具有multiple属性的所有页面元素 ，可以这样 <code>//*[@multiple]</code></p>
<ul>
<li>属性值包含字符串</li>
</ul>
<p>选择 style 属性值<strong>包含</strong> color 字符串的页面元素 ： <code>//*[contains(@style,&#39;color&#39;)]</code></p>
<p>选择 style 属性值以 color 字符串<strong>开头</strong>的 页面元素： <code>//*[starts-with(@style,&#39;color&#39;)]</code></p>
<p>如果是结尾呢？很遗憾，<code>ends-with</code>是XPath 2.0 的语法 ，目前浏览器都不支持。</p>
<h6 id="按次序选择"><a href="#按次序选择" class="headerlink" title="按次序选择"></a>按次序选择</h6><p>XPath 也可以根据次序选择元素。 语法比CSS更简洁，直接在方括号中使用数字表示次序。</p>
<p>选择 p 类型第2个的子元素：<code>//p[2]</code></p>
<ul>
<li>第几个子元素</li>
</ul>
<p>选择父元素为 div 的第2个子元素，不管是什么类型：<code>//div/*[2]</code></p>
<ul>
<li>某类型 倒数第几个子元素</li>
</ul>
<p>选取 p 类型倒数第<strong>1</strong>个子元素：<code>//p[last()]</code>；</p>
<p>选取 p 类型倒数第<strong>2</strong>个子元素：<code>//p[last()-1]</code>，数字是写在括号外面的；</p>
<h6 id="范围选择"><a href="#范围选择" class="headerlink" title="范围选择"></a>范围选择</h6><p>选取 option 类型第1到2个子元素：<code>//option[position()&lt;=2]</code></p>
<p>选择 class 属性为multi_choice的前3个子元素：<code>//*[@class=&#39;multi_choice&#39;]/*[position()&lt;=3]</code></p>
<p>选择 class 属性为multi_choice的后3个子元素：<code>//*[@class=multi_choice]/*[position()&gt;=last()-2]</code></p>
<h6 id="组选择、父节点、兄弟节点"><a href="#组选择、父节点、兄弟节点" class="headerlink" title="组选择、父节点、兄弟节点"></a>组选择、父节点、兄弟节点</h6><ul>
<li>组选择：用 竖线<code>|</code>隔开多个表达式</li>
</ul>
<p>选所有的option元素 和所有的 h4 元素：<code>//option | //h4</code></p>
<ul>
<li>选择父节点</li>
</ul>
<p>XPath可以选择父节点， 这是CSS做不到的。某个元素的父节点用 <code>/..</code> 表示。当某个元素没有特征可以直接选择，但是它有子节点有特征， 就可以采用这种方法，先选择子节点，再指定父节点。</p>
<p>选择 id 为 china 的节点的父节点： <code>//*[@id=&#39;china&#39;]/..</code></p>
<ul>
<li>兄弟节点选择</li>
</ul>
<p>语法 <code>following-sibling::</code>、<code>preceding-sibling::</code></p>
<p>选择 class 为 single_choice 的元素的所有后续兄弟节点 <code>//*[@class=&#39;single_choice&#39;]/following-sibling::*</code></p>
<blockquote>
<p>等同于CSS选择器 <code>.single_choice ~ *</code></p>
</blockquote>
<p>选择 class 为 single_choice 的元素的</p>
<p>前面第n最靠近的兄弟节点：<code>//*[@class=&#39;single_choice&#39;]/preceding-sibling::*[n]</code></p>
<blockquote>
<p>CSS目前还做不到</p>
</blockquote>
<blockquote>
<p>注意：要在某个元素内部使用XPath选择元素， 需要 在XPath表达式最前面加个点<code>.</code> 。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定位xxx元素内部的所有p元素</span></span><br><span class="line">element = wd.find_element(By.ID, <span class="string">&#x27;xxx&#x27;</span>)</span><br><span class="line">elements = element.find_elements(By.XPATH, <span class="string">&#x27;.//p&#x27;</span>)</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="API接口自动化"><a href="#API接口自动化" class="headerlink" title="API接口自动化"></a>API接口自动化</h2><h3 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h3><p>HTTP 协议全称是超文本传输协议， 英文是 Hypertext Transfer Protocol 。HTTP 最初是用来 在 浏览器和网站服务器（web服务）之间 传输超文本（网页、视频、图片等）信息的。由于 HTTP 简洁易用，后来，不仅仅是浏览器和服务器之间使用它， 服务器和服务器之间， 手机App和服务器之间， 都广泛的采用。 成了软件系统间通信的首选协议之一。</p>
<p>HTTP 有好几个版本，包括： <code>0.9</code> 、 <code>1.0</code> 、 <code>1.1</code> 、 <code>2</code> 、 <code>3</code> ，当前最广泛使用的是 <code>HTTP/1.1</code> 版本。HTTP3 以前版本 （除了HTTP3基于UDP，准确来说是基于QUIC协议，QUIC是基于UDP的） , 都是 基于 TCP 协议的， 所以要进行通讯，客户端 必须先 和服务端 创建 TCP 连接。而且 HTTP 双方的信息交互，必须是这样一种方式：</p>
<ul>
<li>客户端 先发送 http请求（request）给 服务端</li>
<li>然后服务端 发送 http响应（response）给 客户端</li>
</ul>
<blockquote>
<p>特别注意：HTTP协议中，服务端不能主动先发送信息给 客户端。</p>
</blockquote>
<p>而且在1.1 以前的版本， 服务端 返回响应给客户端后，连接就会断开 ，下一次双方要进行信息交流，必须重复上面的过程，重新建立连接，客户端发送请求，服务返回响应。到了 1.1 版本， 建立连接后，这个连接可以保持一段时间（keep alive）， 这段时间，双方可以多次进行 请求和响应， 无需重新建立连接。</p>
<h3 id="HTTP请求消息"><a href="#HTTP请求消息" class="headerlink" title="HTTP请求消息"></a>HTTP请求消息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET /mgr/login.html HTTP/1.1 # 请求行</span><br><span class="line">Host: www.baiyueheiyu.com # 以下为请求头</span><br><span class="line">User-Agent: Mozilla/6.0 (compatible; MSIE5.01; Windows NT)</span><br><span class="line">Accept-Language: zh-cn</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST /api/medicine HTTP/1.1 # 请求行</span><br><span class="line">Host: www.baiyueheiyu.com # 以下为请求头</span><br><span class="line">User-Agent: Mozilla/6.0 (compatible; MSIE5.01; Windows NT)</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 51</span><br><span class="line">Accept-Language: zh-cn</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line"></span><br><span class="line">name=qingmeisu&amp;sn=099877883837&amp;desc=qingmeisuyaopin # 消息体</span><br></pre></td></tr></table></figure>

<h4 id="请求行-request-line"><a href="#请求行-request-line" class="headerlink" title="请求行 request line"></a>请求行 request line</h4><p>包含请求方式、URL、协议版本</p>
<blockquote>
<p>请求方式</p>
<ul>
<li><strong>get、post、put、delete</strong>、head、options、trace、connect、patch等</li>
</ul>
</blockquote>
<h4 id="请求头-request-headers"><a href="#请求头-request-headers" class="headerlink" title="请求头 request headers"></a>请求头 request headers</h4><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers">MDN关于请求头标准的描述</a></p>
<p>单个请求头的 格式是：名字: 值，一个请求头占据一行，开发者也可以在HTTP消息中添加自己定义的请求头。</p>
<h4 id="消息体-message-body"><a href="#消息体-message-body" class="headerlink" title="消息体 message body"></a>消息体 message body</h4><p>POST、PUT等请求，添加、修改的数据信息通常都是存放在请求消息体中的。消息头和消息体之间需要插入一个空行隔开。</p>
<p>请求消息体通常是某种格式的文本，常见的有：</p>
<ul>
<li>JSON</li>
<li>Xml</li>
<li>www-form-urlencoded 表单数据</li>
</ul>
<h3 id="HTTP响应消息"><a href="#HTTP响应消息" class="headerlink" title="HTTP响应消息"></a>HTTP响应消息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK # 状态行</span><br><span class="line">Date: Thu, 19 Sep 2019 08:08:27 GMT</span><br><span class="line">Server: WSGIServer/0.2 CPython/3.7.3</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 37</span><br><span class="line">X-Frame-Options: SAMEORIGIN</span><br><span class="line">Vary: Cookie</span><br><span class="line"></span><br><span class="line">&#123;&quot;ret&quot;: 0, &quot;retlist&quot;: [], &quot;total&quot;: 0&#125;</span><br></pre></td></tr></table></figure>

<h4 id="状态行-status-line"><a href="#状态行-status-line" class="headerlink" title="状态行 status line"></a>状态行 status line</h4><blockquote>
<p>状态码</p>
<ul>
<li>2xx</li>
</ul>
<p>通常表示请求消息没有问题，而且服务器也正确处理了;</p>
<ul>
<li>3xx</li>
</ul>
<p>重定向响应，常见的值是301，302， 表示客户端的这个请求的url地址已经改变了， 需要客户端重新发起一个请求到另外的一个url。</p>
<ul>
<li>4xx</li>
</ul>
<p>表示客户端请求有错误， 常见的值有：</p>
<p><code>400 Bad Request</code> 表示客户端请求不符合接口要求，比如格式完全错误；</p>
<p><code>401 Unauthorized</code> 表示客户端需要先认证才能发送次请求；</p>
<p><code>403 Forbidden</code> 表示客户端没有权限要求服务器处理这样的请求， 比如普通用户请求删除别人账号等；</p>
<p><code>404 Not Found</code> 表示客户端请求的url 不存在；</p>
<ul>
<li>5xx</li>
</ul>
<p>表示服务端在处理请求中，发生了未知的错误。</p>
<p>通常是服务端的代码设计问题，或者是服务端子系统出了故障（比如数据库服务宕机了）</p>
</blockquote>
<h4 id="响应头-response-headers"><a href="#响应头-response-headers" class="headerlink" title="响应头 response headers"></a>响应头 response headers</h4><p>作用与请求头类似。</p>
<h4 id="消息体-message-body-1"><a href="#消息体-message-body-1" class="headerlink" title="消息体 message body"></a>消息体 message body</h4><h3 id="接口测试概述"><a href="#接口测试概述" class="headerlink" title="接口测试概述"></a>接口测试概述</h3><p>API接口传递数据信息是通过HTTP协议进行收发的 ， 网站获取网页、图片 、CSS 等资源， 也是通过HTTP协议进行收发的 。</p>
<p>两者的不同点在于，网页、图片、css 这些资源，都是静态资源 ，服务端直接读取文件，返回给客户端即可，无需特别的数据处理。而 API接口请求消息，通常都需要 服务端程序进行一番处理，比如：对请求的权限检查，从数据库中读出数据，进行信息过滤和格式转换，最后在HTTP响应中返回给客户端。</p>
<p>内部接口通常是由开发来做，测试来做内部API的接口测试时，重点是做<strong>漏洞测试</strong>和<strong>破坏性测试</strong>就好了。而外部接口，也就是第三方接口。 测试工程师一定要进行全面测试。</p>
<h3 id="Requests库"><a href="#Requests库" class="headerlink" title="Requests库"></a>Requests库</h3><p><a target="_blank" rel="noopener" href="https://requests.readthedocs.io/en/latest/">requests官网</a></p>
<h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment"># 返回Response对象</span></span><br><span class="line">response = requests.get(<span class="string">&#x27;http://mirrors.sohu.com/&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>

<h4 id="requests程序抓包设置代理为Fiddler"><a href="#requests程序抓包设置代理为Fiddler" class="headerlink" title="requests程序抓包设置代理为Fiddler"></a>requests程序抓包设置代理为Fiddler</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">proxies = &#123;</span><br><span class="line">  <span class="string">&#x27;http&#x27;</span>: <span class="string">&#x27;http://127.0.0.1:8888&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;https&#x27;</span>: <span class="string">&#x27;http://127.0.0.1:8888&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(<span class="string">&#x27;http://mirrors.sohu.com/&#x27;</span>, proxies=proxies)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>

<p>还需要安装Fiddler证书，然后执行命令 <code>pip install python-certifi-win32</code> 安装一个第三方库 ，这样会让python使用本地系统安装的证书。</p>
<h4 id="构建请求参数-params"><a href="#构建请求参数-params" class="headerlink" title="构建请求参数 params"></a>构建请求参数 <strong>params</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">urlpara = &#123;</span><br><span class="line">    <span class="string">&#x27;wd&#x27;</span>:<span class="string">&#x27;iphone&amp;ipad&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;rsv_spt&#x27;</span>:<span class="string">&#x27;1&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(<span class="string">&#x27;https://www.baidu.com/s&#x27;</span>,params=urlpara)</span><br></pre></td></tr></table></figure>

<h4 id="构建请求消息头-headers"><a href="#构建请求消息头-headers" class="headerlink" title="构建请求消息头 headers"></a>构建请求消息头 <strong>headers</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;my-app/0.0.1&#x27;</span>, </span><br><span class="line">    <span class="string">&#x27;auth-type&#x27;</span>: <span class="string">&#x27;jwt-token&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r = requests.post(<span class="string">&quot;http://httpbin.org/post&quot;</span>, headers=headers)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>

<h4 id="构建请求消息体-data"><a href="#构建请求消息体-data" class="headerlink" title="构建请求消息体 data"></a>构建请求消息体 <strong>data</strong></h4><p>消息体可能很短 ，只有一个字节， 比如字符 a。 也可能很长，有几百兆个字节，比如一个视频文件。最常见的消息体格式当然是表示网页内容的 HTML。</p>
<p>消息体就是存放信息的地方，信息的格式完全取决设计者的需要。而Web API接口中，消息体基本都是文本，文本的格式主要是这3种： urlencoded ，JSON ，XML。</p>
<h5 id="XML格式"><a href="#XML格式" class="headerlink" title="XML格式"></a><strong>XML格式</strong></h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">payload = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="string">&lt;WorkReport&gt;</span></span><br><span class="line"><span class="string">    &lt;Overall&gt;良好&lt;/Overall&gt;</span></span><br><span class="line"><span class="string">    &lt;Progress&gt;30%&lt;/Progress&gt;</span></span><br><span class="line"><span class="string">    &lt;Problems&gt;暂无&lt;/Problems&gt;</span></span><br><span class="line"><span class="string">&lt;/WorkReport&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">r = requests.post(<span class="string">&quot;http://httpbin.org/post&quot;</span>,</span><br><span class="line">                 data=payload.encode(<span class="string">&#x27;utf8&#x27;</span>)) <span class="comment"># 缺省会使用latin-1编码</span></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>

<h5 id="urlencoded-格式消息体"><a href="#urlencoded-格式消息体" class="headerlink" title="urlencoded 格式消息体"></a><strong>urlencoded 格式消息体</strong></h5><p>这种格式的消息体就是一种键值对的格式存放数据，可以放到字典里传递。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">payload = &#123;<span class="string">&#x27;key1&#x27;</span>: <span class="string">&#x27;value1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>: <span class="string">&#x27;value2&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">r = requests.post(<span class="string">&quot;http://httpbin.org/post&quot;</span>, data=payload)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>

<h5 id="JSON-格式消息体"><a href="#JSON-格式消息体" class="headerlink" title="JSON 格式消息体"></a><strong>JSON 格式消息体</strong></h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests,json</span><br><span class="line"></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;Overall&quot;</span>:<span class="string">&quot;良好&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Progress&quot;</span>:<span class="string">&quot;30%&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Problems&quot;</span>:[</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;No&quot;</span> : <span class="number">1</span>,</span><br><span class="line">            <span class="string">&quot;desc&quot;</span>: <span class="string">&quot;问题1....&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;No&quot;</span> : <span class="number">2</span>,</span><br><span class="line">            <span class="string">&quot;desc&quot;</span>: <span class="string">&quot;问题2....&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r = requests.post(<span class="string">&quot;http://httpbin.org/post&quot;</span>, data=json.dumps(payload)) <span class="comment"># 使用json库的dumps方法构建json对象</span></span><br></pre></td></tr></table></figure>

<p>也可以将数据对象直接传递给 post 方法的 json 参数，如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r = requests.post(<span class="string">&quot;http://httpbin.org/post&quot;</span>, json=payload)</span><br></pre></td></tr></table></figure>

<h4 id="检查响应状态码"><a href="#检查响应状态码" class="headerlink" title="检查响应状态码"></a>检查响应状态码</h4><p><code>response.status_code</code></p>
<h4 id="检查响应消息头"><a href="#检查响应消息头" class="headerlink" title="检查响应消息头"></a>检查响应消息头</h4><p><code>response.headers</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests,pprint</span><br><span class="line"></span><br><span class="line">response = requests.get(<span class="string">&#x27;http://mirrors.sohu.com/&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(response.headers))</span><br><span class="line"></span><br><span class="line">pprint.pprint(<span class="built_in">dict</span>(response.headers))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>pprint可以更美观的打印数据，直观的展示数据结构</p>
</blockquote>
<h4 id="检查响应消息体"><a href="#检查响应消息体" class="headerlink" title="检查响应消息体"></a>检查响应消息体</h4><p><code>response.text</code></p>
<p>equests 会根据响应消息头（比如 Content-Type）对编码格式做推测，从而包响应消息体中的字节串解码为字符串，但是有时没有指定编码格式，就需要手动指定：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">response = requests.get(<span class="string">&#x27;http://mirrors.sohu.com/&#x27;</span>)</span><br><span class="line">response.encoding=<span class="string">&#x27;utf8&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>要直接获取消息体中的字节串内容，可以使用 <code>response.content</code>。有需要时指定解码方式：<code>response.content.decode(&#39;utf8&#39;)</code>。</p>
</li>
<li><p>对于JSON格式的消息体，可以通过json库的loads函数，把它转化为JSON对象：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests,json</span><br><span class="line">response = requests.post(<span class="string">&quot;http://httpbin.org/post&quot;</span>, data=&#123;<span class="number">1</span>:<span class="number">1</span>,<span class="number">2</span>:<span class="number">2</span>&#125;)</span><br><span class="line"></span><br><span class="line">obj = json.loads(response.content.decode(<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(obj)</span><br></pre></td></tr></table></figure>

<p>requests库为我们提供了更方便的方法，可以使用 Response对象的 json方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">obj = response.json()</span><br><span class="line"><span class="built_in">print</span>(obj)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h3><p>前面学习过Cookie，客户端访问服务器时，服务器会生成唯一id，并通过HTTP响应头的<code>Set-Cookie</code>字段响应给客户端，这个唯一id就是sessionid。在生成sessionid的同时，服务器还生成了session这样一个数据结构，保存该客户这次登录操作相关信息。通常保存在数据库中。</p>
<h3 id="requests处理session-Cookie"><a href="#requests处理session-Cookie" class="headerlink" title="requests处理session-Cookie"></a>requests处理session-Cookie</h3><p>equests库给我们提供一个 <code>Session</code> 类 。通过这个类，无需我们操心， requests库自动帮我们保存服务端返回的 cookie数据， HTTP请求自动 在消息头中放入 cookie 数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建 Session 对象</span></span><br><span class="line">s = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过 Session 对象 发送请求</span></span><br><span class="line">response = s.post(<span class="string">&quot;http://127.0.0.1/api/mgr/signin&quot;</span>,</span><br><span class="line">       data=&#123;</span><br><span class="line">           <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;byhy&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;88888888&#x27;</span></span><br><span class="line">       &#125;)</span><br><span class="line"></span><br><span class="line">printResponse(response) </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 还可以这样写，没有上面简洁</span></span><br><span class="line">req = requests.Request(</span><br><span class="line">    <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;http://www.baidu.com&#x27;</span>,</span><br><span class="line">    headers=&#123;</span><br><span class="line">        <span class="string">&#x27;head1&#x27;</span>:<span class="string">&#x27;value1&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;head2&#x27;</span>:<span class="string">&#x27;value2&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    data=&#123;</span><br><span class="line">        <span class="string">&#x27;item1&#x27;</span>:<span class="string">&#x27;body-value1&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;item2&#x27;</span>:<span class="string">&#x27;body-value2&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">session = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="comment">#  如果这样写 prepared = req.prepare() </span></span><br><span class="line"><span class="comment">#  后续发送会 请求消息头中，会丢掉session中的cookie数据</span></span><br><span class="line"><span class="comment">#  必须像下面这样写，才能让请求包含cookie数据</span></span><br><span class="line">prepared = session.prepare_request(req)</span><br><span class="line"></span><br><span class="line">pretty_print_request(prepared)</span><br><span class="line">r = session.send(prepared)</span><br><span class="line">pretty_print_response(r)</span><br></pre></td></tr></table></figure>

<h3 id="Session对象使用代理"><a href="#Session对象使用代理" class="headerlink" title="Session对象使用代理"></a>Session对象使用代理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">proxies = &#123;<span class="string">&#x27;http&#x27;</span>: <span class="string">&#x27;http://127.0.0.1:8888&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">s = requests.session()</span><br><span class="line"></span><br><span class="line">s.proxies.update(proxies)</span><br><span class="line"></span><br><span class="line">s.get(<span class="string">&quot;http://www.example.com&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="接口测试数据准备"><a href="#接口测试数据准备" class="headerlink" title="接口测试数据准备"></a>接口测试数据准备</h3><p>如果测试的时候，系统前端已经开发完毕，在前端删除。否则可以通过 API 删除接口删除。</p>
<p>尽量不要在数据库中直接删除数据。</p>
<h3 id="封装API测试类"><a href="#封装API测试类" class="headerlink" title="封装API测试类"></a>封装API测试类</h3><p>可以把发送接收API消息封装到库中，这样可以使我们的测试代码更加简洁。比如，我们可以创建一个 webapi.py的库：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span>  pprint</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">APIMgr</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_printResponse</span>(<span class="params">self,response</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\n\n-------- HTTP response * begin -------&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(response.status_code)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> k,v <span class="keyword">in</span> response.headers.items():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;k&#125;</span>: <span class="subst">&#123;v&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(response.content.decode(<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;-------- HTTP response * end -------\n\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mgr_login</span>(<span class="params">self,username,password</span>):</span><br><span class="line">        <span class="variable language_">self</span>.s = requests.Session()</span><br><span class="line">        response = <span class="variable language_">self</span>.s.post(<span class="string">&quot;http://127.0.0.1/api/mgr/signin&quot;</span>,</span><br><span class="line">                                 data=&#123;</span><br><span class="line">                                     <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">                                     <span class="string">&#x27;password&#x27;</span>: password</span><br><span class="line">                                 &#125;</span><br><span class="line">                                 )</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>._printResponse(response)</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">customer_list</span>(<span class="params">self,pagesize,pagenumber,keywords</span>):</span><br><span class="line">        response = <span class="variable language_">self</span>.s.get(<span class="string">&quot;http://127.0.0.1/api/mgr/customers&quot;</span>,</span><br><span class="line">              params=&#123;</span><br><span class="line">                  <span class="string">&#x27;action&#x27;</span> :<span class="string">&#x27;list_customer&#x27;</span>,</span><br><span class="line">                  <span class="string">&#x27;pagesize&#x27;</span> :pagesize,</span><br><span class="line">                  <span class="string">&#x27;pagenum&#x27;</span> :pagenumber,</span><br><span class="line">                  <span class="string">&#x27;keywords&#x27;</span> :keywords,</span><br><span class="line">              &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>._printResponse(response)</span><br><span class="line">        <span class="keyword">return</span> response</span><br></pre></td></tr></table></figure>

<p>调用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> webapi <span class="keyword">import</span> APIMgr</span><br><span class="line">am = APIMgr()</span><br><span class="line">am.mgr_login(<span class="string">&#x27;byhy&#x27;</span>,<span class="string">&#x27;88888888&#x27;</span>)</span><br><span class="line">am.customer_list(<span class="number">1</span>,<span class="number">10</span>,<span class="string">&#x27;&#x27;</span>).</span><br></pre></td></tr></table></figure>

<h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>我们注意到，webapi.py 库文件里面发送API 请求，都是写死了请求的 url ，这样做的问题是，如果我们测试系统安装在另外的机器上，这些代码都得更改IP地址。</p>
<p>所以，我们应该把被测系统的主机地址写在配置文件 <code>cfg/cfg.py</code> 中，如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">target_host = &#x27;127.0.0.1&#x27;</span><br></pre></td></tr></table></figure>

<p>然后，其他代码使用配置文件里面的主机地址，像这样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> cfg <span class="keyword">import</span> cfg</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;登录&#x27;</span>)</span><br><span class="line">response = <span class="variable language_">self</span>.s.post(</span><br><span class="line">    <span class="string">f&quot;http://<span class="subst">&#123;cfg.target_host&#125;</span>/api/mgr/signin&quot;</span>,</span><br><span class="line">    data=&#123;</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>: password</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="自动化测试框架Pytetst"><a href="#自动化测试框架Pytetst" class="headerlink" title="自动化测试框架Pytetst"></a>自动化测试框架Pytetst</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>基于 Python 语言的自动化测试框架 最知名的 有如下 3 款：</p>
<ul>
<li>unittest</li>
<li>pytest</li>
<li>robotframework</li>
</ul>
<p>前两款框架主要（或者说很大程度上）是 聚焦 在 白盒单元测试。</p>
<p>而 robotframework 主要聚焦在 系统测试。</p>
<p>pytest 可以用来做 系统测试 的自动化， 它的特点有：</p>
<ul>
<li>用 Python 编写测试用例，简便易用</li>
<li>可以用 <strong>文件系统目录层次 对应 手工测试用例 层次</strong>结构</li>
<li>灵活的 <strong>初始化清除</strong> 机制</li>
<li>可以<strong>灵活挑选测试用例</strong>执行</li>
<li>利用第三方插件，可以<strong>生成不错的报表</strong></li>
</ul>
<h3 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h3><p>pip安装即可</p>
<h3 id="快速上手"><a href="#快速上手" class="headerlink" title="快速上手"></a>快速上手</h3><ul>
<li><p>编写的测试用例代码文件， 必须以 <code>test_</code> 开头，或者以 <code>_test</code> 结尾；</p>
</li>
<li><p>如果把测试用例存放在类中， 类名必须以 <code>Test</code> 为前缀的 <code>类</code> ，用例对应的方法必须以 <code>test</code> 为前缀的方法。</p>
</li>
<li><p>pytest 中用例的检查点 直接用 Python 的 assert 断言。</p>
</li>
<li><p>进入项目根录，执行pytest即可</p>
</li>
</ul>
<blockquote>
<p>注意：直接执行 <code>pytest</code> 命令不会将当前目录设置为模块搜索路径，所以更推荐 执行命令 <code>python -m pytest</code></p>
</blockquote>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pytest -s //打印测试代码中<span class="built_in">print</span>的内容 -v //打印详细的执行信息如测试类、测试函数的名字 +目标扫描目录路径 --html=report.html --self-contained-html //产生测试报告</span><br></pre></td></tr></table></figure>

<h3 id="初始化清除"><a href="#初始化清除" class="headerlink" title="初始化清除"></a>初始化清除</h3><p>对自动化测试框架来说，初始化清除功能至关重要。</p>
<h5 id="模块级别"><a href="#模块级别" class="headerlink" title="模块级别"></a>模块级别</h5><p>模块级别的初始化、清除分别在整个模块的测试用例执行前后执行，并且只会执行1次 。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">setup_module</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n *** 初始化-模块 ***&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">teardown_module</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n ***   清除-模块 ***&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test_xxx</span>:</span><br><span class="line">    ... ...</span><br></pre></td></tr></table></figure>

<h5 id="类级别"><a href="#类级别" class="headerlink" title="类级别"></a>类级别</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Test_错误密码</span>:</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod </span><span class="comment"># 类方法装饰器</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setup_class</span>(<span class="params">cls</span>): <span class="comment"># 第一个参数固定为cls,而不是self</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\n === 初始化-类 ===&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">teardown_class</span>(<span class="params">cls</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\n === 清除 - 类 ===&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_C001001</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\n用例C001001&#x27;</span>)</span><br><span class="line">        <span class="keyword">assert</span> <span class="number">1</span> == <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>类方法装饰器</p>
<p>可以通过类名.方法名调用该方法</p>
<p>第一个参数固定为cls,而不是self</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 统计类创建了多少个实例</span></span><br><span class="line"><span class="meta">@classmethod</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_count</span>(<span class="params">cls</span>):	</span><br><span class="line">	<span class="keyword">return</span> cls.count</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从字符串构造对象，类方法可以替代构造方法</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):</span><br><span class="line">        <span class="variable language_">self</span>.name = name</span><br><span class="line">        <span class="variable language_">self</span>.age = age</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">from_string</span>(<span class="params">cls, string</span>):</span><br><span class="line">        name, age = string.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> cls(name, <span class="built_in">int</span>(age))</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据不同的类型参数返回不同的子类对象。</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Shape</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, color</span>):</span><br><span class="line">        <span class="variable language_">self</span>.color = color</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">display_color</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Color: <span class="subst">&#123;self.color&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">create_shape</span>(<span class="params">cls, color, <span class="built_in">type</span></span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span> == <span class="string">&quot;circle&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> Circle(color)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&quot;rectangle&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> Rectangle(color)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Circle</span>(<span class="title class_ inherited__">Shape</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">display_shape</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Type: Circle&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Rectangle</span>(<span class="title class_ inherited__">Shape</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">display_shape</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Type: Rectangle&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</blockquote>
<h5 id="方法级别"><a href="#方法级别" class="headerlink" title="方法级别"></a>方法级别</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 类中，没有类方法装饰器</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">setup_method</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n --- 初始化-方法  ---&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">teardown_method</span>(<span class="params">self</span>):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;\n --- 清除  -方法 ---&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_C001001</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n用例C001001&#x27;</span>)</span><br><span class="line">    <span class="keyword">assert</span> <span class="number">1</span> == <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h4 id="目录级别"><a href="#目录级别" class="headerlink" title="目录级别"></a>目录级别</h4><p>在需要初始化的目录下面创建 一个名为 <code>conftest.py</code> 的文件，里面内容如下所示，这是一个生成器</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest </span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.fixture(<span class="params">scope=<span class="string">&#x27;package&#x27;</span>,autouse=<span class="literal">True</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">st_emptyEnv</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;\n#### 初始化-目录甲&#x27;</span>)</span><br><span class="line">    <span class="keyword">yield</span></span><br><span class="line">	<span class="comment"># 在这里写清除环境的代码</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;\n#### 清除-目录甲&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="挑选用例执行"><a href="#挑选用例执行" class="headerlink" title="挑选用例执行"></a>挑选用例执行</h3><h4 id="指定一个模块"><a href="#指定一个模块" class="headerlink" title="指定一个模块"></a>指定一个模块</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pytest cases\登录\test_错误登录.py</span><br></pre></td></tr></table></figure>

<h4 id="指定一个或多个目录"><a href="#指定一个或多个目录" class="headerlink" title="指定一个或多个目录"></a>指定一个或多个目录</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pytest cases1  cases2\登录</span><br></pre></td></tr></table></figure>

<h4 id="指定模块里面的函数或者类"><a href="#指定模块里面的函数或者类" class="headerlink" title="指定模块里面的函数或者类"></a>指定模块里面的函数或者类</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 指定一个类</span><br><span class="line">python -m pytest cases\登录\test_错误登录.py::Test_错误密码</span><br><span class="line"></span><br><span class="line"># 指定类中的方法</span><br><span class="line">python -m pytest cases\登录\test_错误登录.py::Test_错误密码::test_C001001</span><br></pre></td></tr></table></figure>

<h4 id="根据名字"><a href="#根据名字" class="headerlink" title="根据名字"></a>根据名字</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python -m pytest -k C001001 -s # C001001可以是要测试函数名字的一部分，并且可以用and、<span class="keyword">not</span>和or来进行筛选</span><br><span class="line"></span><br><span class="line">python -m pytest -k &quot;<span class="keyword">not</span> C001001&quot; -s</span><br><span class="line">python -m pytest -k &quot;错 and 密码<span class="number">2</span>&quot; -s</span><br><span class="line">python -m pytest -k &quot;错 or 密码<span class="number">2</span>&quot; -s</span><br></pre></td></tr></table></figure>

<h4 id="根据标签"><a href="#根据标签" class="headerlink" title="根据标签"></a>根据标签</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test_错误密码2</span>:</span><br><span class="line"></span><br><span class="line"><span class="meta">    @pytest.mark.webtest</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_C001021</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\n用例C001021&#x27;</span>)</span><br><span class="line">        <span class="keyword">assert</span> <span class="number">1</span> == <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>执行命令</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pytest cases -m webtest -s</span><br></pre></td></tr></table></figure>

<p>也可以给整个类加上标签，并且可以是中文，可以添加多个标签。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@pytest.mark.webtest</span></span><br><span class="line"><span class="meta">@pytest.mark.登录测试</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test_错误密码2</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_C001021</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\n用例C001021&#x27;</span>)</span><br><span class="line">        <span class="keyword">assert</span> <span class="number">1</span> == <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>可以这样定义一个全局变量 pytestmark 为<strong>整个模块文件</strong>设定标签</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import pytest</span><br><span class="line">pytestmark = pytest.mark.网页测试</span><br></pre></td></tr></table></figure>

<p>如果需要定义多个标签，可以定义一个列表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import pytest</span><br><span class="line">pytestmark = [pytest.mark.网页测试, pytest.mark.登录测试]</span><br></pre></td></tr></table></figure>

<p>自定义的标签，运行时，pytest会有告警。</p>
<p>可以在项目根目录下创建配置文件 <code>pytest.ini</code> 并且在里面设置标签配置项，如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[pytest]</span><br><span class="line">markers =</span><br><span class="line">    critical: critical tests</span><br><span class="line">    网页测试: 标记为网页测试</span><br></pre></td></tr></table></figure>

<h3 id="数据驱动"><a href="#数据驱动" class="headerlink" title="数据驱动"></a>数据驱动</h3><p>如果有一批测试用例，具有相同的测试步骤 ，只是测试参数数据不同。自动化测试时，把测试数据从用例代码中分离开来，以后增加新的测试用例，只需要修改数据，这就是数据驱动。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Test_错误登录</span>:</span><br><span class="line"><span class="meta">    @pytest.mark.parametrize(<span class="params"><span class="string">&#x27;username, password, expectedalert&#x27;</span>, [</span></span></span><br><span class="line"><span class="params"><span class="meta">        (<span class="params"><span class="literal">None</span>, <span class="string">&#x27;88888888&#x27;</span>, <span class="string">&#x27;请输入用户名&#x27;</span></span>),</span></span></span><br><span class="line"><span class="params"><span class="meta">        (<span class="params"><span class="string">&#x27;byhy&#x27;</span>, <span class="literal">None</span>, <span class="string">&#x27;请输入密码&#x27;</span></span>),</span></span></span><br><span class="line"><span class="params"><span class="meta">        (<span class="params"><span class="string">&#x27;byh&#x27;</span>, <span class="string">&#x27;88888888&#x27;</span>, <span class="string">&#x27;登录失败 : 用户名或者密码错误&#x27;</span></span>),</span></span></span><br><span class="line"><span class="params"><span class="meta">        (<span class="params"><span class="string">&#x27;byhy&#x27;</span>, <span class="string">&#x27;8888888&#x27;</span>, <span class="string">&#x27;登录失败 : 用户名或者密码错误&#x27;</span></span>),</span></span></span><br><span class="line"><span class="params"><span class="meta">        (<span class="params"><span class="string">&#x27;byhy&#x27;</span>, <span class="string">&#x27;888888888&#x27;</span>, <span class="string">&#x27;登录失败 : 用户名或者密码错误&#x27;</span></span>),</span></span></span><br><span class="line"><span class="params"><span class="meta">    ]</span></span></span><br><span class="line"><span class="params"><span class="meta">                             </span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_UI_0001_0005</span>(<span class="params">self, username, password, expectedalert</span>):</span><br><span class="line">        alertText = loginAndCheck(username, password)</span><br><span class="line">        <span class="keyword">assert</span> alertText == expectedalert</span><br></pre></td></tr></table></figure>

<p>参考<a target="_blank" rel="noopener" href="https://docs.pytest.org/en/latest/how-to/parametrize.html">pytest官网数据驱动</a></p>
<h3 id="使用-fixture"><a href="#使用-fixture" class="headerlink" title="使用 fixture"></a>使用 fixture</h3><p>前面讲初始化清除时，主要用的是 unittest 风格的初始化清除方法。pytest里面有更灵活方便的初始化、清除 方法，就是使用 <code>fixture</code>。跟spring的依赖注入类似。</p>
<h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个fixture函数</span></span><br><span class="line"><span class="meta">@pytest.fixture</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createzhangSan</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n ***  执行创建张三账号的代码 ***&#x27;</span>)</span><br><span class="line">    zhangSan = &#123;</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>   : <span class="string">&#x27;zhangsan&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>   : <span class="string">&#x27;111111&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;invitecode&#x27;</span> : <span class="string">&#x27;abcdefg&#x27;</span> <span class="comment"># 这是系统创建用户产生的其它信息</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">yield</span> zhangSan <span class="comment"># 用yield代替return</span></span><br><span class="line">	<span class="comment"># 这里写清除部分的代码</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n ***  执行清除张三账号的代码 ***&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_A001001</span>(<span class="params">createzhangSan</span>): <span class="comment"># 参数为fixture函数名</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n用例 A001001&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\ninvitecode is&#x27;</span>, createzhangSan[<span class="string">&#x27;invitecode&#x27;</span>])</span><br></pre></td></tr></table></figure>

<h4 id="fixture本身需要参数"><a href="#fixture本身需要参数" class="headerlink" title="fixture本身需要参数"></a>fixture本身需要参数</h4><p>就需要使用parametrize装饰器，并指定参数<code>indirect=True</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytest</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个fixture函数</span></span><br><span class="line"><span class="meta">@pytest.fixture</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createUser</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="comment"># 这里代码实现了使用API创建用户账号功能</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n *** createUser ***&#x27;</span>)</span><br><span class="line">    user = &#123;</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>   : request.param[<span class="number">0</span>],</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>   : request.param[<span class="number">1</span>],</span><br><span class="line">        <span class="string">&#x27;invitecode&#x27;</span> : <span class="string">&#x27;abcdefg&#x27;</span> <span class="comment"># 这是系统创建用户产生的其它信息</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> user</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.mark.parametrize(<span class="params"><span class="string">&quot;createUser&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="meta">                         [(<span class="params"><span class="string">&quot;zhangsan&quot;</span>, <span class="string">&quot;111&quot;</span></span>)],</span></span></span><br><span class="line"><span class="params"><span class="meta">                         indirect=<span class="literal">True</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_A001001</span>(<span class="params">createUser</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n用例 A001001&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\nusername is&#x27;</span>, createUser[<span class="string">&#x27;username&#x27;</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;测试行为1111&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@pytest.mark.parametrize(<span class="params"><span class="string">&quot;createUser&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="meta">                         [(<span class="params"><span class="string">&quot;lisi&quot;</span>, <span class="string">&quot;111&quot;</span></span>)],</span></span></span><br><span class="line"><span class="params"><span class="meta">                         indirect=<span class="literal">True</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_A001002</span>(<span class="params">createUser</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n用例 A001002&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\nusername is&#x27;</span>, createUser[<span class="string">&#x27;username&#x27;</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;测试行为2222&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这里fixture参数request是特殊的名字，是pytest内置的fixture SubRequest对象，这个对象的param属性是一个tuple，里面保存了传入的一个个参数。</p>
</blockquote>
<h4 id="fixture范围"><a href="#fixture范围" class="headerlink" title="fixture范围"></a>fixture范围</h4><p>fixture 由小到大，有下面这几种级别范围：</p>
<ul>
<li><code>function</code> : 函数级别，缺省值</li>
</ul>
<p>会在测试函数结束时执行 fixture 对应的清除</p>
<ul>
<li><code>class</code> : 类级别</li>
</ul>
<p>会在 类 里面的最后一个测试方法 结束时 执行 fixture 对应的清除</p>
<ul>
<li><code>module</code> : 模块文件级别</li>
</ul>
<p>会在 模块文件 里面的最后一个测试方法 结束时 执行 fixture 对应的清除</p>
<ul>
<li><code>package</code> : 目录级别</li>
</ul>
<p>会在 目录 里面的最后一个测试方法 结束时 执行 fixture 对应的清除</p>
<ul>
<li><code>session</code> : 整个测试 级别</li>
</ul>
<p>会在 整个测试 的最后一个测试方法 结束时 执行 fixture 对应的清除</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@pytest.fixture(<span class="params">scope=<span class="string">&#x27;function&#x27;</span> autouse=<span class="literal">False</span></span>) </span></span><br><span class="line"><span class="comment"># scope缺省为function，函数级别</span></span><br><span class="line"><span class="comment"># autouse参数的作用为是否设置默认使用fixture，设置为True后，就不用在用例方法的参数中写上fixture函数名了，会自动调用。</span></span><br><span class="line"><span class="keyword">def</span> ...</span><br></pre></td></tr></table></figure>





<p>参考链接：</p>
<p>【1】<a target="_blank" rel="noopener" href="https://www.byhy.net/">https://www.byhy.net/</a></p>
<p>【2】<a target="_blank" rel="noopener" href="https://blog.csdn.net/amateurSU/article/details/136673353?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522105926cb47529f5403a759b1d346971f%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=105926cb47529f5403a759b1d346971f&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-136673353-null-null.142%5Ev101%5Epc_search_result_base7&utm_term=@classmethod&spm=1018.2226.3001.4187">https://blog.csdn.net/amateurSU/article/details/136673353?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522105926cb47529f5403a759b1d346971f%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=105926cb47529f5403a759b1d346971f&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-136673353-null-null.142^v101^pc_search_result_base7&amp;utm_term=%40classmethod&amp;spm=1018.2226.3001.4187</a></p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">Cris Kou</div><div class="post-copyright__author_desc">千里之行，始于足下</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2025/02/16/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2025/02/16/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/')">自动化测试</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2025/02/16/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=自动化测试&amp;url=http://example.com/2025/02/16/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/&amp;pic=" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Cris Kou的成长日记</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>自动化测试<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/02/15/JMeter-%E5%B7%A5%E5%85%B7/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">JMeter[工具]</div></div></a></div><div class="next-post pull-right"><a href="/2025/02/16/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">读书笔记</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/zc998800/cdn/face/gif/p113.gif" alt="status"/></div></div><div class="author-info__description"></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95"><span class="toc-number">1.</span> <span class="toc-text">自动化测试</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB-UI%E8%87%AA%E5%8A%A8%E5%8C%96"><span class="toc-number">1.1.</span> <span class="toc-text">WEB UI自动化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Selenium"><span class="toc-number">1.1.1.</span> <span class="toc-text">Selenium</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">工作原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.1.1.3.</span> <span class="toc-text">示例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="toc-number">1.1.1.4.</span> <span class="toc-text">常见问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E5%85%83%E7%B4%A0"><span class="toc-number">1.1.1.5.</span> <span class="toc-text">选择元素</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AEid%E5%B1%9E%E6%80%A7%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0"><span class="toc-number">1.1.1.5.1.</span> <span class="toc-text">根据id属性定位元素</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AEclass%E5%B1%9E%E6%80%A7%E9%80%89%E6%8B%A9%E5%85%83%E7%B4%A0"><span class="toc-number">1.1.1.5.2.</span> <span class="toc-text">根据class属性选择元素</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AEtag%E5%90%8D%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0"><span class="toc-number">1.1.1.5.3.</span> <span class="toc-text">根据tag名定位元素</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%9A%E8%BF%87WebElement%E5%AF%B9%E8%B1%A1%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0"><span class="toc-number">1.1.1.5.4.</span> <span class="toc-text">通过WebElement对象定位元素</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E6%8E%A7%E5%85%83%E7%B4%A0"><span class="toc-number">1.1.1.5.5.</span> <span class="toc-text">操控元素</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CSS%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">1.1.1.5.6.</span> <span class="toc-text">CSS表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE-tag%E5%90%8D%E3%80%81id%E3%80%81class-%E9%80%89%E6%8B%A9%E5%85%83%E7%B4%A0"><span class="toc-number">1.1.1.5.6.1.</span> <span class="toc-text">根据 tag名、id、class 选择元素</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E5%AD%90%E5%85%83%E7%B4%A0%E5%92%8C%E5%90%8E%E4%BB%A3%E5%85%83%E7%B4%A0"><span class="toc-number">1.1.1.5.6.2.</span> <span class="toc-text">选择子元素和后代元素</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE%E5%B1%9E%E6%80%A7%E9%80%89%E6%8B%A9"><span class="toc-number">1.1.1.5.6.3.</span> <span class="toc-text">根据属性选择</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%81%94%E5%90%88%E4%BD%BF%E7%94%A8"><span class="toc-number">1.1.1.5.6.4.</span> <span class="toc-text">联合使用</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BB%84%E9%80%89%E6%8B%A9"><span class="toc-number">1.1.1.5.6.5.</span> <span class="toc-text">组选择</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%8C%89%E6%AC%A1%E5%BA%8F%E9%80%89%E6%8B%A9%E5%AD%90%E8%8A%82%E7%82%B9"><span class="toc-number">1.1.1.5.6.6.</span> <span class="toc-text">按次序选择子节点</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%85%84%E5%BC%9F%E8%8A%82%E7%82%B9%E9%80%89%E6%8B%A9"><span class="toc-number">1.1.1.5.6.7.</span> <span class="toc-text">兄弟节点选择</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#XPath%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-number">1.1.1.5.7.</span> <span class="toc-text">XPath选择器</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%E9%80%89%E6%8B%A9"><span class="toc-number">1.1.1.5.7.1.</span> <span class="toc-text">绝对路径选择</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84%E9%80%89%E6%8B%A9"><span class="toc-number">1.1.1.5.7.2.</span> <span class="toc-text">相对路径选择</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="toc-number">1.1.1.5.7.3.</span> <span class="toc-text">通配符</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE%E5%B1%9E%E6%80%A7%E9%80%89%E6%8B%A9-1"><span class="toc-number">1.1.1.5.7.4.</span> <span class="toc-text">根据属性选择</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%8C%89%E6%AC%A1%E5%BA%8F%E9%80%89%E6%8B%A9"><span class="toc-number">1.1.1.5.7.5.</span> <span class="toc-text">按次序选择</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8C%83%E5%9B%B4%E9%80%89%E6%8B%A9"><span class="toc-number">1.1.1.5.7.6.</span> <span class="toc-text">范围选择</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%BB%84%E9%80%89%E6%8B%A9%E3%80%81%E7%88%B6%E8%8A%82%E7%82%B9%E3%80%81%E5%85%84%E5%BC%9F%E8%8A%82%E7%82%B9"><span class="toc-number">1.1.1.5.7.7.</span> <span class="toc-text">组选择、父节点、兄弟节点</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#API%E6%8E%A5%E5%8F%A3%E8%87%AA%E5%8A%A8%E5%8C%96"><span class="toc-number">1.2.</span> <span class="toc-text">API接口自动化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.2.1.</span> <span class="toc-text">HTTP协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP%E8%AF%B7%E6%B1%82%E6%B6%88%E6%81%AF"><span class="toc-number">1.2.2.</span> <span class="toc-text">HTTP请求消息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E8%A1%8C-request-line"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">请求行 request line</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%A4%B4-request-headers"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">请求头 request headers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E4%BD%93-message-body"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">消息体 message body</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP%E5%93%8D%E5%BA%94%E6%B6%88%E6%81%AF"><span class="toc-number">1.2.3.</span> <span class="toc-text">HTTP响应消息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E8%A1%8C-status-line"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">状态行 status line</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E5%A4%B4-response-headers"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">响应头 response headers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E4%BD%93-message-body-1"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">消息体 message body</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95%E6%A6%82%E8%BF%B0"><span class="toc-number">1.2.4.</span> <span class="toc-text">接口测试概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Requests%E5%BA%93"><span class="toc-number">1.2.5.</span> <span class="toc-text">Requests库</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#requests%E7%A8%8B%E5%BA%8F%E6%8A%93%E5%8C%85%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86%E4%B8%BAFiddler"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">requests程序抓包设置代理为Fiddler</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0-params"><span class="toc-number">1.2.5.3.</span> <span class="toc-text">构建请求参数 params</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E8%AF%B7%E6%B1%82%E6%B6%88%E6%81%AF%E5%A4%B4-headers"><span class="toc-number">1.2.5.4.</span> <span class="toc-text">构建请求消息头 headers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E8%AF%B7%E6%B1%82%E6%B6%88%E6%81%AF%E4%BD%93-data"><span class="toc-number">1.2.5.5.</span> <span class="toc-text">构建请求消息体 data</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#XML%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.2.5.5.1.</span> <span class="toc-text">XML格式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#urlencoded-%E6%A0%BC%E5%BC%8F%E6%B6%88%E6%81%AF%E4%BD%93"><span class="toc-number">1.2.5.5.2.</span> <span class="toc-text">urlencoded 格式消息体</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#JSON-%E6%A0%BC%E5%BC%8F%E6%B6%88%E6%81%AF%E4%BD%93"><span class="toc-number">1.2.5.5.3.</span> <span class="toc-text">JSON 格式消息体</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%93%8D%E5%BA%94%E7%8A%B6%E6%80%81%E7%A0%81"><span class="toc-number">1.2.5.6.</span> <span class="toc-text">检查响应状态码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%93%8D%E5%BA%94%E6%B6%88%E6%81%AF%E5%A4%B4"><span class="toc-number">1.2.5.7.</span> <span class="toc-text">检查响应消息头</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%93%8D%E5%BA%94%E6%B6%88%E6%81%AF%E4%BD%93"><span class="toc-number">1.2.5.8.</span> <span class="toc-text">检查响应消息体</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Session"><span class="toc-number">1.2.6.</span> <span class="toc-text">Session</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#requests%E5%A4%84%E7%90%86session-Cookie"><span class="toc-number">1.2.7.</span> <span class="toc-text">requests处理session-Cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Session%E5%AF%B9%E8%B1%A1%E4%BD%BF%E7%94%A8%E4%BB%A3%E7%90%86"><span class="toc-number">1.2.8.</span> <span class="toc-text">Session对象使用代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87"><span class="toc-number">1.2.9.</span> <span class="toc-text">接口测试数据准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85API%E6%B5%8B%E8%AF%95%E7%B1%BB"><span class="toc-number">1.2.10.</span> <span class="toc-text">封装API测试类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.11.</span> <span class="toc-text">配置文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6Pytetst"><span class="toc-number">1.3.</span> <span class="toc-text">自动化测试框架Pytetst</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.3.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-1"><span class="toc-number">1.3.2.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B"><span class="toc-number">1.3.3.</span> <span class="toc-text">快速上手</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E6%B8%85%E9%99%A4"><span class="toc-number">1.3.4.</span> <span class="toc-text">初始化清除</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E7%BA%A7%E5%88%AB"><span class="toc-number">1.3.4.0.1.</span> <span class="toc-text">模块级别</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%B1%BB%E7%BA%A7%E5%88%AB"><span class="toc-number">1.3.4.0.2.</span> <span class="toc-text">类级别</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E7%BA%A7%E5%88%AB"><span class="toc-number">1.3.4.0.3.</span> <span class="toc-text">方法级别</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E7%BA%A7%E5%88%AB"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">目录级别</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%91%E9%80%89%E7%94%A8%E4%BE%8B%E6%89%A7%E8%A1%8C"><span class="toc-number">1.3.5.</span> <span class="toc-text">挑选用例执行</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E4%B8%80%E4%B8%AA%E6%A8%A1%E5%9D%97"><span class="toc-number">1.3.5.1.</span> <span class="toc-text">指定一个模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E4%B8%80%E4%B8%AA%E6%88%96%E5%A4%9A%E4%B8%AA%E7%9B%AE%E5%BD%95"><span class="toc-number">1.3.5.2.</span> <span class="toc-text">指定一个或多个目录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E6%A8%A1%E5%9D%97%E9%87%8C%E9%9D%A2%E7%9A%84%E5%87%BD%E6%95%B0%E6%88%96%E8%80%85%E7%B1%BB"><span class="toc-number">1.3.5.3.</span> <span class="toc-text">指定模块里面的函数或者类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE%E5%90%8D%E5%AD%97"><span class="toc-number">1.3.5.4.</span> <span class="toc-text">根据名字</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE%E6%A0%87%E7%AD%BE"><span class="toc-number">1.3.5.5.</span> <span class="toc-text">根据标签</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%A9%B1%E5%8A%A8"><span class="toc-number">1.3.6.</span> <span class="toc-text">数据驱动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-fixture"><span class="toc-number">1.3.7.</span> <span class="toc-text">使用 fixture</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-number">1.3.7.1.</span> <span class="toc-text">例子</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fixture%E6%9C%AC%E8%BA%AB%E9%9C%80%E8%A6%81%E5%8F%82%E6%95%B0"><span class="toc-number">1.3.7.2.</span> <span class="toc-text">fixture本身需要参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fixture%E8%8C%83%E5%9B%B4"><span class="toc-number">1.3.7.3.</span> <span class="toc-text">fixture范围</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/17/Linux%E8%BF%90%E7%BB%B4/" title="Linux运维">Linux运维</a><time datetime="2025-02-17T01:35:17.000Z" title="发表于 2025-02-17 09:35:17">2025-02-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/16/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" title="读书笔记">读书笔记</a><time datetime="2025-02-16T06:26:25.000Z" title="发表于 2025-02-16 14:26:25">2025-02-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/16/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" title="自动化测试">自动化测试</a><time datetime="2025-02-16T01:42:27.000Z" title="发表于 2025-02-16 09:42:27">2025-02-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/15/JMeter-%E5%B7%A5%E5%85%B7/" title="JMeter[工具]">JMeter[工具]</a><time datetime="2025-02-15T05:19:28.000Z" title="发表于 2025-02-15 13:19:28">2025-02-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/15/%E6%B5%8B%E8%AF%95%E7%90%86%E8%AE%BA/" title="测试理论">测试理论</a><time datetime="2025-02-15T02:02:21.000Z" title="发表于 2025-02-15 10:02:21">2025-02-15</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2025 By <a class="footer-bar-link" href="/" title="Cris Kou" target="_blank">Cris Kou</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">8</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">0</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>1</sup></a><a href="/tags/Python%E5%9F%BA%E7%A1%80/" style="font-size: 0.88rem;">Python基础<sup>1</sup></a><a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="font-size: 0.88rem;">学习笔记<sup>1</sup></a><a href="/tags/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/" style="font-size: 0.88rem;">测试工具<sup>3</sup></a><a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/" style="font-size: 0.88rem;">自动化测试<sup>1</sup></a><a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" style="font-size: 0.88rem;">读书笔记<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Cris Kou 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>